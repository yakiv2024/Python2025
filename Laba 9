import csv
import os

input_file = "Data.csv"
output_file = "results.csv"

try:
    with open(input_file, "r", encoding="utf-8") as csvfile:
        reader = csv.DictReader(csvfile)
        found = False

        for row in reader:
            if row["Country Name"].strip().lower() == "ukraine":
                found = True
                print("Life expectancy at birth, total (years) for Ukraine (1991–2019):\n")
                values = {}

                for year in range(1991, 2020):
                    column = f"{year} [YR{year}]"
                    val_str = row.get(column, "").strip()
                    if val_str:
                        try:
                            val = float(val_str)
                            values[year] = val
                            print(f"{year}: {val}")
                        except ValueError:
                            continue

                if not values:
                    print("\nNo numeric data found for Ukraine.")
                else:
                    min_year = min(values, key=values.get)
                    max_year = max(values, key=values.get)
                    min_value = values[min_year]
                    max_value = values[max_year]

                    print("\nLowest life expectancy:")
                    print(f"{min_year}: {min_value}")

                    print("\nHighest life expectancy:")
                    print(f"{max_year}: {max_value}")

                    try:
                        with open(output_file, "w", newline="", encoding="utf-8") as out_csv:
                            writer = csv.writer(out_csv, delimiter=";")
                            writer.writerow(["Year", "Life expectancy (years)"])
                            writer.writerow([min_year, min_value])
                            writer.writerow([max_year, max_value])
                        print(f"\nResults saved to file: {output_file}")
                    except PermissionError:
                        print("\nПомилка неможливо записати у файл файл відкрито або захищено")
                    except Exception as e:
                        print(f"\nПомилка запису у файл: {e}")
                break

        if not found:
            print("Ukraine not found in file")

except FileNotFoundError:
    print("Помилка файл Data.csv не знайдено")
except PermissionError:
    print("Помилка неможливо відкрити файл Data.csv немає доступу")
except Exception as e:
    print(f"Інша помилка при читанні файлу: {e}")



import json
import os

cars = [
    {"Модель": "Toyota Corolla", "Ціна": 12000, "Вік": 5},
    {"Модель": "Honda Civic", "Ціна": 9000, "Вік": 7},
    {"Модель": "Ford Focus", "Ціна": 8500, "Вік": 9},
    {"Модель": "BMW 320i", "Ціна": 18000, "Вік": 4},
    {"Модель": "Audi A4", "Ціна": 21000, "Вік": 8},
    {"Модель": "Skoda Octavia", "Ціна": 11000, "Вік": 10},
    {"Модель": "Mazda 3", "Ціна": 9500, "Вік": 6},
    {"Модель": "Hyundai Elantra", "Ціна": 10500, "Вік": 7},
    {"Модель": "Kia Rio", "Ціна": 7500, "Вік": 11},
    {"Модель": "Volkswagen Golf", "Ціна": 13000, "Вік": 5}
]

# створюємо початковий файл
try:
    jsonData = json.dumps(cars, ensure_ascii=False, indent=4)
    with open("cars.json", "wt", encoding="utf-8") as file:
        file.write(jsonData)
except PermissionError:
    print("Помилка неможливо записати у файл cars.json доступ заборонено.")
except Exception as e:
    print(f"Інша помилка при створенні файлу cars.json {e}")

while True:
    print("\nОберіть дію:")
    print("1 - Додати новий автомобіль")
    print("2 - Переглянути усі автомобілі")
    print("3 - Видалити автомобіль за моделлю")
    print("4 - Знайти середню ціну автомобілів старших за 6 років")
    print("5 - Пошук автомобіля за одним із полів")
    print("6 - Вийти")

    try:
        x = int(input("Ваш вибір: "))
    except ValueError:
        print("Помилка введіть число від 1 до 6.")
        continue

    if x == 1:
        # додавання нового авто
        try:
            with open("cars.json", "rt", encoding="utf-8") as file:
                cars = json.load(file)
        except FileNotFoundError:
            print("Помилка файл cars.json не знайдено.")
            continue
        except json.JSONDecodeError:
            print("Помилка файл cars.json пошкоджено.")
            continue

        print("Додавання нового автомобіля:")
        model = input("Модель: ")
        try:
            price = float(input("Ціна: "))
            age = int(input("Вік : "))
        except ValueError:
            print("Помилка некоректне введення чисел.")
            continue

        cars.append({"Модель": model, "Ціна": price, "Вік": age})

        try:
            with open("cars.json", "wt", encoding="utf-8") as file:
                json.dump(cars, file, ensure_ascii=False, indent=4)
            print("Автомобіль успішно додано.")
        except PermissionError:
            print("Помилка файл cars.json відкрито в іншій програмі.")
        except Exception as e:
            print(f"Помилка запису у файл cars.json: {e}")

    elif x == 2:
        # перегляд усіх авто
        try:
            with open("cars.json", "rt", encoding="utf-8") as file:
                cars = json.load(file)
                print("\nСписок автомобілів:")
                for c in cars:
                    print(c)
        except FileNotFoundError:
            print("Помилка: файл cars.json не знайдено.")
        except json.JSONDecodeError:
            print("Помилка: файл cars.json пошкоджено.")
        except Exception as e:
            print(f"Інша помилка при читанні файлу: {e}")

    elif x == 3:
        # видалення авто
        try:
            with open("cars.json", "rt", encoding="utf-8") as file:
                cars = json.load(file)
        except Exception as e:
            print(f"Помилка відкриття файлу: {e}")
            continue

        model_to_delete = input("Введіть модель автомобіля для видалення: ")
        found = False
        for car in cars:
            if car["Модель"].lower() == model_to_delete.lower():
                cars.remove(car)
                found = True
                break

        if found:
            try:
                with open("cars.json", "wt", encoding="utf-8") as file:
                    json.dump(cars, file, ensure_ascii=False, indent=4)
                print(f"Автомобіль '{model_to_delete}' успішно видалено.")
            except Exception as e:
                print(f"Помилка запису у файл: {e}")
        else:
            print("Такої моделі не знайдено у файлі.")

    elif x == 4:
        # середня ціна старших за 6 років
        try:
            with open("cars.json", "rt", encoding="utf-8") as file:
                cars = json.load(file)
        except Exception as e:
            print(f"Помилка відкриття файлу: {e}")
            continue

        old_cars = [car["Ціна"] for car in cars if car["Вік"] > 6]
        if old_cars:
            avg_price = sum(old_cars) / len(old_cars)
            print(f"Середня ціна автомобілів старших за 6 років: {avg_price:.2f} $")

            try:
                with open("result12.json", "wt", encoding="utf-8") as file:
                    json.dump({"Середня ціна автомобілів старших за 6 років": avg_price},
                              file, ensure_ascii=False, indent=4)
                print("Результат збережено у 'result12.json'.")
            except Exception as e:
                print(f"Помилка запису результатів: {e}")
        else:
            print("Автомобілів старших за 6 років не знайдено.")

    elif x == 5:
        # пошук авто
        try:
            with open("cars.json", "rt", encoding="utf-8") as file:
                cars = json.load(file)
        except Exception as e:
            print(f"Помилка відкриття файлу: {e}")
            continue

        print("\nПошук за полем:")
        print("1 - Модель")
        print("2 - Ціна")
        print("3 - Вік")

        try:
            choice = int(input("Ваш вибір: "))
        except ValueError:
            print("Помилка введіть число 1, 2 або 3.")
            continue

        found = []
        if choice == 1:
            model = input("Введіть назву моделі: ").lower()
            found = [c for c in cars if model in c["Модель"].lower()]
        elif choice == 2:
            try:
                price = float(input("Введіть ціну: "))
                found = [c for c in cars if c["Ціна"] == price]
            except ValueError:
                print("Помилка введіть коректну ціну.")
                continue
        elif choice == 3:
            try:
                age = int(input("Введіть вік: "))
                found = [c for c in cars if c["Вік"] == age]
            except ValueError:
                print("Помилка введіть коректний вік")
                continue
        else:
            print("Невірний вибір поля")
            continue

        if found:
            print("\nЗнайдено такі автомобілі:")
            for c in found:
                print(c)
        else:
            print("Автомобілів за заданим критерієм не знайдено.")

    elif x == 6:
        print("Завершення роботи програми")
        break  
    else:
        print("Невірний вибір. Спробуйте ще раз.")





